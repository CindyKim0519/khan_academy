<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>대시보드</title>
    <link rel="stylesheet" href="/src/main/resources/static/css/bootstrap.min.css">
    <link rel="stylesheet" href="/src/main/resources/static/css/style.min.css">
</head>
<body>
    <header class="header d-flex align-items-center justify-content-between px-3 py-2 border-bottom bg-white">
        <img src="" alt="">
        <div class="d-flex align-items-center">
            <span>관리자</span>
            <span class="text-secondary me-3">님 환영합니다</span>
            <button class="btn btn-sm btn-outline-dark d-flex align-items-center">
                <i class="fa-solid fa-arrow-right-from-bracket me-1"></i>
                <span>로그아웃</span>
            </button>
        </div>
    </header>
    <div class="d-flex">
        <nav class="sidebar bg-white border-end">
            <div class="nav flex-column">
                <a href="#!" class="nav-link py-3 px-4 text-secondary d-flex align-items-center">
                    <i class="fa-solid fa-chart-simple me-3"></i>
                    대시보드
                </a>
                <a href="#!" class="nav-link py-3 px-4 text-secondary d-flex align-items-center">
                    <i class="fa-solid fa-desktop me-3"></i>
                    클래스 관리
                </a>
                <a href="#!" class="nav-link py-3 px-4 text-secondary d-flex align-items-center">
                    <i class="fa-solid fa-credit-card me-3"></i>
                    학생 관리
                </a>
                <a href="#!" class="nav-link py-3 px-4 text-secondary d-flex align-items-center">
                    <i class="fa-solid fa-user me-3"></i>
                    과제 관리
                </a>
            </div>
        </nav>
    </div>
    <main class="main-content px-4 py-4">
        <div class="row g-3">
            <div class="col-6">
                <ol class="breadcrumb">
                    <li class="breadcrumb-item">
                        <a href="#!">
                            <i class="fa-solid fa-house text-secondary" width="18" height="18"></i>
                        </a>
                    </li>
                    <li class="breadcrumb-item">
                        <a href="#!" class="text-decoration-none text-secondary">대시보드</a>
                    </li>
                </ol>
                <h2 class="fw-bold mb-5">대시보드</h2>
                <div class="row g-3">
                    <div class="col-6">
                        <div class="card mb-3">
                            <div class="card-body">
                                <div class="d-flex justify-content-between mb-3">
                                    <span class="text-secondary font-size-sm">오늘 신규 가입자</span>
                                    <img src="/src/main/resources/static/images/newcomers.png" alt="" class="dashboard-icon-size">
                                </div>
                                <span class="fw-bold font-size-lg">1,270명</span>
                            </div>
                        </div>
                        <div class="card mb-3">
                            <div class="card-body">
                                <div class="d-flex align-items-center justify-content-between mb-3">
                                    <span class="text-secondary font-size-sm">오늘 활성 사용자</span>
                                    <img src="/src/main/resources/static/images/active.png" alt="" class="dashboard-icon-size">
                                </div>
                                <span class="fw-bold font-size-lg">18,626명</span>
                            </div>
                        </div>
                    </div>
                    <div class="col-6">
                        <div class="card mb-3">
                            <div class="card-body">
                                <div class="d-flex justify-content-between mb-3">
                                    <span class="text-secondary font-size-sm">월별 평균 클래스 완료율</span>
                                    <img src="/src/main/resources/static/images/class.png" alt="" class="dashboard-icon-size">
                                </div>
                                <span class="fw-bold font-size-lg">87.2%</span>
                            </div>
                        </div>
                        <div class="card">
                            <div class="card-body">
                                <div class="d-flex justify-content-between mb-3">
                                    <span class="text-secondary font-size-sm">오늘 생성된 클래스</span>
                                    <img src="/src/main/resources/static/images/newClass.png" alt="" class="dashboard-icon-size">
                                </div>
                                <span class="fw-bold font-size-lg">353건</span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="col-6">
                <div class="card">
                    <div class="card-header d-flex justify-content-between align-items-center">
                        <span>사용자 증가 추이</span>
                        <select class="form-select" style="width: 130px;">
                            <option value="최근 7일">최근 7일</option>
                            <option value="최근 30일" selected>최근 30일</option>
                            <option value="최근 90일">최근 90일</option>
                            <option value="최근 1년">최근 1년</option>
                        </select>
                    </div>
                    <div class="card-body">
                       <div id="user-trend-chart" class="chart-container"></div>
                    </div>
                </div>
            </div>
            <div class="col-4">
                <div class="card">
                    <div class="card-header d-flex justify-content-between align-items-center">
                        <div class="d-flex flex-column">
                            <span>과목별 학생수</span>
                            <span class="font-size-sm text-secondary">12월 1주차</span>
                        </div>
                        <select class="form-select" style="width: 83px;">
                            <option value="일간">일간</option>
                            <option value="주간" selected>주간</option>
                            <option value="월간">월간</option>
                        </select>
                    </div>
                    <div class="card-body">
                        <div id="subject-students-chart" class="chart-container"></div>
                    </div>
                </div>
            </div>
            <div class="col-4">
                <div class="card">
                    <div class="card-header d-flex justify-content-between align-items-center">
                        <div class="d-flex flex-column">        
                            <span>마스터리 달성률</span>
                            <span class="text-secondary font-size-sm">2024년 12월</span>
                        </div>
                        <select class="form-select" style="width: 83px">
                            <option value="주간">주간</option>
                            <option value="월간" selected>월간</option>
                        </select>
                    </div>
                    <div class="card-body">
                        <div id="mastery-chart" class="chart-container"></div>
                    </div>
                </div>
            </div>
            <div class="col-4">
                <div class="card">
                    <div class="card-header d-flex justify-content-between align-items-center">
                        <div class="d-flex flex-column">
                            <span>기부 현황</span>
                            <span class="text-secondary font-size-sm">2024년 12월</span>
                        </div>
                        <select class="form-select" style="width: 83px;">
                            <option value="월간" selected>월간</option>
                            <option value="연간">연간</option>
                        </select>
                    </div>
                    <div class="card-body">
                        <div id="donation-chart" class="chart-container"></div>
                    </div>
                </div>
            </div>
            <div class="col-6">
                <div class="card">
                    <div class="card-header d-flex align-items-center justify-content-between">
                        <div class="d-flex flex-column">
                            <span>평균 학습시간 추이</span>
                            <span class="text-secondary font-size-sm">최근 8일간</span>
                        </div>
                        <select class="form-select" style="width: 83px;">
                            <option value="일간" selected>일간</option>
                            <option value="주간">주간</option>
                            <option value="월간">월간</option>
                        </select>
                    </div>
                    <div class="card-body">
                        <div id="study-time-chart" class="chart-container"></div>
                    </div>
                </div>
            </div>
            <div class="col-6">
                <div class="card">
                    <div class="card-header d-flex align-items-center justify-content-between">
                        <div class="d-flex flex-column">
                            <span>오류 영향도 분석</span>
                            <span class="text-secondary font-size-sm">12월 1주차</span>
                        </div>
                        <select class="form-select" style="width: 83px;">
                            <option value="일간">오늘</option>
                            <option value="주간" selected>주간</option>
                            <option value="월간">월간</option>
                        </select>
                    </div>
                    <div class="card-body">
                        <div id="error-bubble-chart" class="chart-container"></div>
                    </div>
                </div>
            </div>
            <div class="col-4">
                <div class="card">
                    <div class="card-header d-flex align-items-center justify-content-between">
                        <div class="d-flex flex-column">
                            <span>댓글 활동 분포</span>
                            <span class="text-secondary font-size-sm">2024년 12월 6일</span>
                        </div>
                        <select class="form-select" style="width: 83px;">
                            <option value="오늘" selected>오늘</option>
                            <option value="어제">어제</option>
                        </select>
                    </div>
                    <div class="card-body">
                        <div id="comments-chart" class="chart-container"></div>
                    </div>
                </div>
            </div>
            <div class="col-4">
                <div class="card">
                    <div class="card-header">
                        <div class="d-flex justify-content-between align-items-center">
                            <div class="d-flex flex-column">
                                <span>인기 콘텐츠 TOP 5</span>
                                <span class="text-secondary font-size-sm">12월 1주차</span>
                            </div>
                            <select class="form-select" style="width: 83px;">
                                <option value="일간">오늘</option>
                                <option value="주간" selected>주간</option>
                                <option value="월간">월간</option>
                            </select>
                        </div>
                    </div>
                    <div class="card-body">
                        <ul class="list-unstyled mb-0">
                            <li class="mb-3">
                                <div class="d-flex align-items-center justify-content-between">
                                    <div class="d-flex align-items-center">
                                        <div style="width: 30px; height: 30px;" class="rounded-2 text-dark circle-border-gray d-flex align-items-center justify-content-center me-3">1</div>
                                        <span>기초 미적분학</span>
                                    </div>
                                    <span class="fw-bold text-nowrap">15,234명</span>
                                </div>
                            </li>
                            <li class="mb-3">
                                <div class="d-flex align-items-center justify-content-between">
                                    <div class="d-flex align-items-center">
                                        <div style="width: 30px; height: 30px;" class="rounded-2 text-dark circle-border-gray d-flex align-items-center justify-content-center me-3">2</div>
                                        <span>Python 프로그래밍 기초</span>
                                    </div>
                                    <span class="fw-bold text-nowrap">12,876명</span>
                                </div>
                            </li>
                            <li class="mb-3">
                                <div class="d-flex align-items-center justify-content-between">
                                    <div class="d-flex align-items-center">
                                        <div style="width: 30px; height: 30px;" class="rounded-2 text-dark circle-border-gray d-flex align-items-center justify-content-center me-3">3</div>
                                        <span>세계사 개관</span>
                                    </div>
                                    <span class="fw-bold text-nowrap">11,543명</span>
                                </div>
                            </li>
                            <li class="mb-3">
                                <div class="d-flex align-items-center justify-content-between">
                                    <div class="d-flex align-items-center">
                                        <div style="width: 30px; height: 30px;" class="rounded-2 text-dark circle-border-gray d-flex align-items-center justify-content-center me-3">4</div>
                                        <span>기초 물리학</span>
                                    </div>
                                    <span class="fw-bold text-nowrap">9,821명</span>
                                </div>
                            </li>
                            <li>
                                <div class="d-flex align-items-center justify-content-between">
                                    <div class="d-flex align-items-center">
                                        <div style="width: 30px; height: 30px;" class="rounded-2 text-dark circle-border-gray d-flex align-items-center justify-content-center me-3">5</div>
                                        <span>영어 문법 완성</span>
                                    </div>
                                    <span class="fw-bold text-nowrap">8,967명</span>
                                </div>
                            </li>
                        </ul>                         
                    </div>
                </div>
            </div>
            <div class="col-4">
                <div class="card">
                    <div class="card-header d-flex align-items-center justify-content-between">
                        <div class="d-flex flex-column">
                            <span>인기 검색어</span>
                            <span class="text-secondary font-size-sm">12월 1주차</span>
                        </div>
                        <select class="form-select" style="width: 83px;">
                            <option value="일간">오늘</option>
                            <option value="주간" selected>주간</option>
                            <option value="월간">월간</option>
                        </select>
                    </div>
                    <div class="card-body">
                        <ul class="list-unstyled mb-0">
                            <li class="mb-3">
                                <div class="d-flex align-items-center justify-content-between">
                                    <div class="d-flex align-items-center">
                                        <div style="width: 30px; height: 30px;" class="rounded-2 text-dark circle-border-gray d-flex align-items-center justify-content-center me-3">1</div>
                                        <span class="text-truncate overflow-hidden" style="width: 130px;">Python</span>
                                    </div>
                                    <span class="fw-bold text-nowrap">1,234회</span>
                                </div>
                            </li>
                            <li class="mb-3">
                                <div class="d-flex align-items-center justify-content-between">
                                    <div class="d-flex align-items-center">
                                        <div style="width: 30px; height: 30px;" class="rounded-2 text-dark circle-border-gray d-flex align-items-center justify-content-center me-3">2</div>
                                        <span class="text-truncate overflow-hidden" style="width: 130px;">미적분</span>
                                    </div>
                                    <span class="fw-bold text-nowrap">987회</span>
                                </div>
                            </li>
                            <li class="mb-3">
                                <div class="d-flex align-items-center justify-content-between">
                                    <div class="d-flex align-items-center">
                                        <div style="width: 30px; height: 30px;" class="rounded-2 text-dark circle-border-gray d-flex align-items-center justify-content-center me-3">3</div>
                                        <span class="text-truncate overflow-hidden" style="width: 130px;">물리학</span>
                                    </div>
                                    <span class="fw-bold text-nowrap">756회</span>
                                </div>
                            </li>
                            <li class="mb-3">
                                <div class="d-flex align-items-center justify-content-between">
                                    <div class="d-flex align-items-center">
                                        <div style="width: 30px; height: 30px;" class="rounded-2 text-dark circle-border-gray d-flex align-items-center justify-content-center me-3">4</div>
                                        <span class="text-truncate overflow-hidden" style="width: 130px;">역사</span>
                                    </div>
                                    <span class="fw-bold text-nowrap">654회</span>
                                </div>
                            </li>
                            <li>
                                <div class="d-flex align-items-center justify-content-between">
                                    <div class="d-flex align-items-center">
                                        <div style="width: 30px; height: 30px;" class="rounded-2 text-dark circle-border-gray d-flex align-items-center justify-content-center me-3">5</div>
                                        <span class="text-truncate overflow-hidden" style="width: 130px;">문법</span>
                                    </div>
                                    <span class="fw-bold text-nowrap">543회</span>
                                </div>
                            </li>
                        </ul>       
                    </div>
                </div>
            </div>
        </div>

    </main>
    <script src="/src/main/resources/static/vendors/jquery-3.7.1/jquery-3.7.1.js"></script>
    <script src="/src/main/resources/static/vendors/bootstrap5/js/bootstrap.bundle.js"></script>
    <script src="/src/main/resources/static/vendors/fontawesome/all.min.js"></script>
    <script src="/src/main/resources/static/vendors/echarts/echarts.min.js"></script>
    <script>
      // 11개 카테고리 마스터리 달성률 도넛 차트
const masteryChart = echarts.init(document.getElementById('mastery-chart'));

const masteryOption = {
    tooltip: {
        trigger: 'item',
        formatter: function(params) {
            const totalLearners = 120; // 1억 2천만 명
            const learnerCount = (params.value / 100 * totalLearners).toFixed(1);
            return `
                <div style="font-size: 14px; line-height: 1.8; padding: 10px;">
                    <strong style="color: ${params.color};">${params.name}</strong><br/>
                    마스터리 달성률: <strong>${params.value}%</strong><br/>
                    예상 학습자 수: <strong>${learnerCount}백만 명</strong>
                </div>
            `;
        }
    },
    legend: {
        orient: 'vertical',
        left: '0%',
        top: 'center',
        textStyle: { 
            fontSize: 11,
            color: '#333'
        },
        itemGap: 8,
        itemWidth: 14,
        itemHeight: 14,
        formatter: function(name) {
            return name.length > 20 ? name.substring(0, 20) + '...' : name;
        }
    },
    series: [
        {
            name: '카테고리별 숙련도',
            type: 'pie',
            radius: ['35%', '60%'],
            center: ['70%', '50%'],
            avoidLabelOverlap: false,
            label: {
                show: false,
                position: 'outside',
                formatter: function(params) {
                    return `${params.value}%`;
                },
                fontSize: 10,
                color: '#333'
            },
            emphasis: {
                label: {
                    show: true,
                    fontSize: '12',
                    fontWeight: 'bold'
                },
                itemStyle: {
                    shadowBlur: 10,
                    shadowOffsetX: 0,
                    shadowColor: 'rgba(0, 0, 0, 0.5)'
                }
            },
            labelLine: {
                show: true,
                length: 8,
                length2: 5
            },
            data: [
                {
                    value: 16, 
                    name: '수학: 유치원 - 8학년', 
                    itemStyle: {color: '#055D3C'}
                },
                {
                    value: 14, 
                    name: '수학: 고등학교 및 대학교', 
                    itemStyle: {color: '#067A49'}
                },
                {
                    value: 13, 
                    name: '과학', 
                    itemStyle: {color: '#0B9660'}
                },
                {
                    value: 12, 
                    name: '수학: 준비 과정', 
                    itemStyle: {color: '#0CA65B'}
                },
                {
                    value: 8, 
                    name: '컴퓨팅', 
                    itemStyle: {color: '#08A157'}
                },
                {
                    value: 7, 
                    name: '읽기 및 언어 예술', 
                    itemStyle: {color: '#14BF96'}
                },
                {
                    value: 6, 
                    name: '시험 준비', 
                    itemStyle: {color: '#10D07A'}
                },
                {
                    value: 5, 
                    name: '경제학', 
                    itemStyle: {color: '#1AE094'}
                },
                {
                    value: 4, 
                    name: '사회 과학', 
                    itemStyle: {color: '#24F0AC'}
                },
                {
                    value: 4, 
                    name: '협력 과정', 
                    itemStyle: {color: '#20E8A0'}
                },
                {
                    value: 3, 
                    name: '생활 기술', 
                    itemStyle: {color: '#16E086'}
                }
            ]
        }
    ],
};

masteryChart.setOption(masteryOption);

// 과목별 학생수 막대 그래프
const subjectChart = echarts.init(document.getElementById('subject-students-chart'));
const subjectOption = {
    tooltip: {
        trigger: 'axis',
        axisPointer: {
            type: 'shadow'
        },
        formatter: function(params) {
            const param = params[0];
            return `
                <div style="font-size: 14px; line-height: 1.8; padding: 10px;">
                    <strong style="color: ${param.color};">${param.name}</strong><br/>
                    등록 학생 수: <strong>${param.value.toLocaleString()}명</strong><br/>
                    전체 대비 비율: <strong>${((param.value / 29360) * 100).toFixed(1)}%</strong>
                </div>
            `;
        }
    },
    grid: {
        left: '0%',
        right: '5%',
        top: '0%',
        bottom: '0%',
        containLabel: true
    },
    xAxis: {
        type: 'value',
        axisLabel: {
            fontSize: 12
        }
    },
    yAxis: {
        type: 'category',
        data: [
            '파트너 과정',
            '사회',
            '생활기능',
            '국어',
            '컴퓨터과학',
            '과학',
            '경제',
            '시험준비',
            '수학: 고등학교 및 대학교',
            '수학: 준비 과정',
            '수학: 유치원-8학년'
        ],
        axisLabel: { 
            fontSize: 11,
            interval: 0
        }
    },
    series: [
        {
            name: '학생수',
            type: 'bar',
            data: [850, 1240, 1580, 2150, 2680, 3420, 1890, 2970, 4100, 3650, 4850],
            itemStyle: {
                color: '#14BF96'
            }
        }
    ]
};
subjectChart.setOption(subjectOption);

// 사용자 증가 추이
const userTrendChart = echarts.init(document.getElementById('user-trend-chart'));
const dates = [];
const newUsers = [];
const activeUsers = [];

for (let i = 29; i >= 0; i--) {
    const date = new Date();
    date.setDate(date.getDate() - i);
    dates.push(date.toLocaleDateString('ko-KR', {month: 'short', day: 'numeric'}));
    newUsers.push(Math.floor(Math.random() * 500) + 800);
    activeUsers.push(Math.floor(Math.random() * 2000) + 15000);
}

const userTrendOption = {
    tooltip: {
        trigger: 'axis',
        formatter: function(params) {
            let result = `<div style="font-size: 14px; line-height: 1.8; padding: 10px;">`;
            result += `<strong>${params[0].axisValue}</strong><br/>`;
            params.forEach(param => {
                result += `<span style="color: ${param.color};">● ${param.seriesName}: <strong>${param.value.toLocaleString()}명</strong></span><br/>`;
            });
            result += `</div>`;
            return result;
        }
    },
    legend: {
        data: ['신규 가입자', '활성 사용자']
    },
    grid: {
        left: '0%',
        right: '1%',
        bottom: '0%',
        top: '15%',
        containLabel: true
    },
    xAxis: {
        type: 'category',
        boundaryGap: false,
        data: dates
    },
    yAxis: {
        type: 'value',
    },
    series: [
        {
            name: '신규 가입자',
            type: 'line',
            data: newUsers,
            itemStyle: { color: '#14BF96' }
        },
        {
            name: '활성 사용자',
            type: 'line',
            data: activeUsers,
            itemStyle: { color: '#10D07A' }
        }
    ]
};
userTrendChart.setOption(userTrendOption);

// 댓글 활동 시간대별
const commentsChart = echarts.init(document.getElementById('comments-chart'));
const commentsOption = {
    tooltip: {
        trigger: 'axis',
        formatter: function(params) {
            const param = params[0];
            const timeRange = param.name;
            const totalComments = [45, 23, 12, 67, 234, 456, 678, 543, 432, 567, 345, 123].reduce((a, b) => a + b, 0);
            const percentage = ((param.value / totalComments) * 100).toFixed(1);
            return `
                <div style="font-size: 14px; line-height: 1.8; padding: 10px;">
                    <strong style="color: ${param.color};">시간대: ${timeRange}</strong><br/>
                    댓글 수: <strong>${param.value}개</strong><br/>
                </div>
            `;
        }
    },
    grid: {
        left: '0%',
        right: '0%',
        bottom: '0%',
        top: '5%',
        containLabel: true
    },
    xAxis: {
        type: 'category',
        data: ['00-02', '02-04', '04-06', '06-08', '08-10', '10-12', '12-14', '14-16', '16-18', '18-20', '20-22', '22-00']
    },
    yAxis: {
        type: 'value'
    },
    series: [
        {
            name: '댓글 수',
            type: 'bar',
            data: [45, 23, 12, 67, 234, 456, 678, 543, 432, 567, 345, 123],
            itemStyle: {
                color: '#14BF96'
            }
        }
    ]
};
commentsChart.setOption(commentsOption);

// 기부 현황 파이 차트
const donationChart = echarts.init(document.getElementById('donation-chart'));
const donationOption = {
    tooltip: {
        trigger: 'item',
        formatter: function(params) {
            const totalDonation = 28500 + 12800 + 6532;
            const percentage = ((params.value / totalDonation) * 100).toFixed(1);
            return `
                <div style="font-size: 14px; line-height: 1.8; padding: 10px;">
                    <strong style="color: ${params.color};">${params.name}</strong><br/>
                    기부 금액: <strong>$${params.value.toLocaleString()}</strong><br/>
                    전체 비율: <strong>${percentage}%</strong><br/>
                </div>
            `;
        }
    },
    legend: {
        orient: 'vertical',
        left: 'left',
        textStyle: { fontSize: 10 }
    },
    series: [
        {
            name: '기부 유형',
            type: 'pie',
            radius: '60%',
            data: [
                {value: 28500, name: '개인 기부자', itemStyle: {color: '#0CA65B'}},
                {value: 12800, name: '기업 후원', itemStyle: {color: '#14BF96'}},
                {value: 6532, name: '정기 기부', itemStyle: {color: '#10D07A'}}
            ],
            emphasis: {
                itemStyle: {
                    shadowBlur: 10,
                    shadowOffsetX: 0,
                    shadowColor: 'rgba(0, 0, 0, 0.5)'
                }
            },
            label: {
                show: false
            }
        }
    ]
};
donationChart.setOption(donationOption);

// 학습 시간 추이
const studyTimeChart = echarts.init(document.getElementById('study-time-chart'));
const studyTimeOption = {
    tooltip: {
        trigger: 'axis',
        formatter: function(params) {
            const param = params[0];
            const hours = Math.floor(param.value / 60);
            const minutes = param.value % 60;
            const timeString = hours > 0 ? `${hours}시간 ${minutes}분` : `${minutes}분`;
            return `
                <div style="font-size: 14px; line-height: 1.8; padding: 10px;">
                    <strong style="color: ${param.color};">${param.name}</strong><br/>
                    평균 학습시간: <strong>${timeString}</strong><br/>
                </div>
            `;
        }
    },
    grid: {
        left: '0%',
        right: '0%',
        bottom: '0%',
        top: '5%',
        containLabel: true
    },
    xAxis: {
        type: 'category',
        data: ['1주전', '6일전', '5일전', '4일전', '3일전', '2일전', '어제', '오늘']
    },
    yAxis: {
        type: 'value',
    },
    series: [
        {
            name: '평균 학습시간',
            type: 'line',
            smooth: true,
            data: [65, 72, 68, 75, 82, 78, 85, 88],
            itemStyle: { color: '#14BF96' },
            areaStyle: {
                color: new echarts.graphic.LinearGradient(0, 0, 0, 1, [
                    {offset: 0, color: 'rgba(20, 191, 150, 0.3)'},
                    {offset: 1, color: 'rgba(20, 191, 150, 0.1)'}
                ])
            }
        }
    ]
};
studyTimeChart.setOption(studyTimeOption);

// 오류 영향도 버블 차트
const errorBubbleChart = echarts.init(document.getElementById('error-bubble-chart'));
const errorBubbleOption = {
    tooltip: {
        trigger: 'item',
        formatter: function(params) {
            const severityColor = {
                '심각': '#055D3C',
                '중간': '#0B9660', 
                '경미': '#14BF96'
            };
            return `
                <div style="font-size: 14px; line-height: 1.8; padding: 10px;">
                    <strong style="color: ${severityColor[params.data[4]]};">${params.data[3]}</strong><br/>
                    발생 빈도: <strong>${params.data[1]}회/일</strong><br/>
                    영향 사용자: <strong>${params.data[2].toLocaleString()}명</strong><br/>
                    심각도: <strong>${params.data[4]}</strong><br/>
                </div>
            `;
        }
    },
    legend: {
        right: '10%',
        top: '0%',
        data: ['심각', '중간', '경미']
    },
    grid: {
        left: '10%',
        top: '15%',
        right: '0%',
        bottom: '20%'
    },
    xAxis: {
        type: 'category',
        data: ['로그인', '동영상재생', '과제제출', '결제', '검색', '프로필', '댓글', '클래스생성'],
        name: '오류 발생 페이지',
        nameLocation: 'middle',
        nameGap: 30,
        axisLabel: {
            rotate: 45,
            fontSize: 10
        }
    },
    yAxis: {
        type: 'value',
        name: '발생 빈도 (회/일)',
        nameLocation: 'middle',
        nameGap: 50,
        scale: true
    },
    series: [
        {
            name: '심각',
            type: 'scatter',
            symbolSize: function (data) {
                return Math.sqrt(data[2]) / 3; // 사용자 수에 비례한 버블 크기
            },
            itemStyle: {
                color: '#055D3C',
                opacity: 0.8
            },
            data: [
                [0, 45, 1200, '로그인 실패', '심각'], // [x축인덱스, y값, 버블크기, 페이지명, 심각도]
                [3, 23, 800, '결제 오류', '심각'],
                [4, 38, 950, '검색 오류', '심각'],
                [7, 12, 400, '클래스 생성 실패', '심각']
            ]
        },
        {
            name: '중간',
            type: 'scatter',
            symbolSize: function (data) {
                return Math.sqrt(data[2]) / 3;
            },
            itemStyle: {
                color: '#0B9660',
                opacity: 0.8
            },
            data: [
                [1, 67, 2100, '동영상 재생 오류', '중간'],
                [2, 89, 1800, '과제 제출 지연', '중간'],
                [5, 45, 1100, '프로필 로딩 지연', '중간'],
                [6, 56, 1350, '댓글 작성 오류', '중간'],
                [0, 34, 900, '로그인 지연', '중간'],
                [4, 42, 1050, '검색 결과 지연', '중간']
            ]
        },
        {
            name: '경미',
            type: 'scatter',
            symbolSize: function (data) {
                return Math.sqrt(data[2]) / 3;
            },
            itemStyle: {
                color: '#14BF96',
                opacity: 0.8
            },
            data: [
                [1, 123, 2800, '동영상 품질 저하', '경미'],
                [2, 78, 1600, '과제 UI 깨짐', '경미'],
                [3, 45, 950, '결제 페이지 스타일', '경미'],
                [5, 67, 1400, '프로필 이미지 깨짐', '경미'],
                [6, 89, 1900, '댓글 정렬 오류', '경미'],
                [7, 34, 750, '클래스 썸네일 오류', '경미']
            ]
        }
    ]
};
errorBubbleChart.setOption(errorBubbleOption);

// 검색 키워드 워드클라우드 (막대그래프로 대체)
const searchChart = echarts.init(document.getElementById('search-keywords'));
const searchOption = {
    tooltip: {
        trigger: 'axis',
        axisPointer: {
            type: 'shadow'
        },
        formatter: function(params) {
            const param = params[0];
            const totalSearches = [543, 654, 756, 987, 1234].reduce((a, b) => a + b, 0);
            const percentage = ((param.value / totalSearches) * 100).toFixed(1);
            return `
                <div style="font-size: 14px; line-height: 1.8; padding: 10px;">
                    <strong style="color: ${param.color};">${param.name}</strong><br/>
                    검색 횟수: <strong>${param.value.toLocaleString()}회</strong><br/>
                    전체 대비: <strong>${percentage}%</strong><br/>
                    일평균: <strong>${(param.value / 30).toFixed(0)}회/일</strong><br/>
                    주간 증가율: <strong>+${(Math.random() * 20 + 5).toFixed(1)}%</strong>
                </div>
            `;
        }
    },
    grid: {
        left: '3%',
        right: '6%',
        bottom: '3%',
        top: '5%',
        containLabel: true
    },
    xAxis: {
        type: 'value'
    },
    yAxis: {
        type: 'category',
        data: ['문법', '역사', '물리학', '미적분', 'Python'],  // 순서 뒤집기
        axisLabel: { fontSize: 10 }
    },
    series: [
        {
            name: '검색 횟수',
            type: 'bar',
            data: [543, 654, 756, 987, 1234],  // 순서 뒤집기
            itemStyle: {
                color: '#14BF96'
            }
        }
    ]
};
searchChart.setOption(searchOption);
    </script>
</body>
</html>